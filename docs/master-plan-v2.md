# Market Intel Dashboard 完整规划方案

> 版本：v2.2（现状对齐可执行版）
> 更新日期：2026-02-14
> 说明：本文件用于总体方案与边界约束，**实际开发顺序与勾选状态只维护在 `docs/todo.md`**。

---

## 1. 项目愿景与核心场景

### 1.1 项目定位

面向个人/小团队的财经分析系统，通过 LLM 对多资产新闻与行情进行聚合分析，输出可追溯、可执行的市场洞察。

### 1.2 核心用户场景

| 场景 | 描述 | 当前状态 |
|------|------|---------|
| A. 每日市场摘要 | 定时生成宏观+微观市场总结 | ✅ 基础能力已完成 |
| B. 热门股票追踪 | 跟踪科技板块热点与异动 | 🔄 计划阶段9增强 |
| C. 未上市科技公司情报 | 跟踪 OpenAI/Anthropic/字节等 | 🔄 计划阶段8建设 |
| D. 跨资产关联分析 | 股债汇贵金属联动分析 | 🔄 计划阶段9建设 |
| E. 个股深度研究 | 财报+新闻+行情聚合研报 | 🔄 计划阶段7真实化 |
| F. 事件因果追踪 | 事件到资产的传导链分析 | 🔄 计划阶段9建设 |

### 1.3 资产覆盖范围（按内部资产 ID）

#### 已支持
- 美股/指数：`AAPL`, `MSFT`, `NVDA`, `AMZN`, `META`, `GOOGL`, `TSLA`, `AMD`, `AVGO`, `ARM`, `PLTR`, `CRM`, `NASDAQ`, `SPX`
- 港股：`0700.HK`, `9988.HK`, `3690.HK`, `9618.HK`
- 外汇：`DXY`, `EURUSD`, `USDJPY`, `USDCNH`
- 债券：`US10Y`
- 贵金属：`XAUUSD`, `XAGUSD`

#### 规划中
- 债券补充：`US02Y`, `US30Y`
- 加密货币（可选）：`BTCUSD`, `ETHUSD`
- 指数补充：`DJI`, `VIX`

#### 科技关注池（修订后，阶段8/9执行基准）

- 美股科技巨头：`NVDA`, `MSFT`, `AAPL`, `AMZN`, `META`, `GOOGL`, `TSLA`, `AMD`, `AVGO`, `ARM`, `PLTR`, `CRM`
- 港股科技标的：`0700.HK`, `9988.HK`, `3690.HK`, `9618.HK`, `9866.HK`, `1810.HK`, `2015.HK`, `1024.HK`
- 待纳入关注：`MiniMax`（当前未上市，先纳入未上市情报池）

#### 未上市公司种子列表（修订后）

| 公司 | 状态 | 核心产品 | 关联概念 |
|------|------|---------|---------|
| OpenAI | 未上市 | GPT 系列, Sora | MSFT |
| Anthropic | 未上市 | Claude 系列 | GOOGL |
| ByteDance | 未上市 | 豆包大模型, 云雀 | 省广集团等 |
| Moonshot AI | 未上市 | Kimi | 未上市 |
| Databricks | 未上市 | 数据 AI 平台 | 未上市 |
| Stripe | 未上市 | 支付基础设施 | 未上市 |
| SpaceX | 未上市 | 星链, 火箭 | 未上市 |
| Scale AI | 未上市 | 数据标注 | 未上市 |
| Anduril | 未上市 | 国防科技 | 未上市 |
| Figure AI | 未上市 | 人形机器人 | 未上市 |
| 01万物（零一万物） | 未上市 | 通用大模型 | 未上市 |
| 百川智能 | 未上市 | 通用大模型 | 未上市 |
| 阶跃星辰 | 未上市 | 多模态大模型 | 未上市 |
| DeepSeek | 未上市 | 推理大模型 | 未上市 |

#### 内部 ID 与行情源映射说明

| 内部资产 ID | 行情源符号（示例） |
|-------------|------------------|
| `NASDAQ` | `^NDX` |
| `SPX` | `^SPX` |
| `US10Y` | `^TNX` |
| `DXY` | `DX-Y.NYB` |
| `XAUUSD` | `GC=F` |

---

## 2. 当前项目状态（与代码对齐）

### 2.1 阶段快照

| 阶段 | 状态 | 说明 |
|------|------|------|
| 阶段0 | ✅ 已完成 | 阻塞修复与一致性 |
| 阶段1 | ✅ 已完成 | 每日新闻闭环 |
| 阶段2 | ✅ 已完成 | 前端对接与体验 |
| 阶段3 | ✅ 已完成 | HKMA 自动化与标准化 |
| 阶段4 | ✅ 已完成 | 任务编排与异步分析 |
| 阶段5 | ✅ 已完成 | 行情能力扩展与 E2E 补齐 |
| 阶段99 | ⏳ 进行中 | 静态类型告警收口 |
| 阶段6-10 | ⏳ 待执行 | 见 `docs/todo.md` |

### 2.2 阶段5收尾结果

| 任务 | 状态 |
|------|------|
| 真实行情接入 | ✅ 完成 |
| 行情标准模型（QuotePoint/QuoteSeries） | ✅ 完成 |
| 资产页真实数据优先 | ✅ 完成 |
| Dashboard 快照真实化 | ✅ 完成 |
| 行情链路端到端测试 | ✅ 完成 |
| 可选 pgvector 开关接入 | ✅ 完成 |

### 2.3 数据存储现状

```
InMemoryStore（默认）
├── events / quotes / refresh_report
└── 重启后可通过刷新任务恢复

ChromaDB（默认向量检索）
└── events 语义检索

SQLite（可选，默认关闭）
└── 轻量持久化

Postgres + pgvector（可选，默认关闭）
└── 向量检索与索引优化（阶段6主线）
```

**结论**：当前设计为“默认轻量 + 可选增强”，避免把持久化策略硬绑定到单一后端。

---

## 3. v2.2 路线图（执行顺序以 todo 为准）

### 阶段99：静态类型告警收口（并行低优先）
- 收敛 mypy/pyright 告警到可控白名单
- 将类型检查纳入 CI 门禁

### 阶段6：Postgres + pgvector 索引优化与运维脚本
- 完成可开关的 PG 向量存储实现
- 建立初始化、健康检查、回填脚本
- 与现有 Chroma 路径并行兼容

### 阶段7：Research 页面真实化
- 上市公司：行情 + 财报 + 相关新闻 + 分析
- 移除演示态兜底文案（保留技术降级而非产品演示）
- 前后端统一“数据来源/时间戳”展示

### 阶段8：未上市公司情报引擎
- 未上市公司档案、关键事件、时间线
- 事件抽取与实体匹配，支持人工补录
- 明确区分 Seed 与实时采集来源
- 基于“修订后 14 家种子列表”优先落地首批覆盖

### 阶段9：科技热度 + 关联分析 + 因果链路
- 科技板块热度评分
- 跨资产相关性矩阵（7/30/90 天）
- 事件因果分析与证据链引用
- 前端通过页签切换 3 套关注资产组合（A/B/C）

#### 阶段9 资产组合方案（页签切换）

| 方案 | 名称 | 资产组合 | 适用场景 |
|------|------|---------|---------|
| A | 宏观核心 | `DXY + US10Y + US02Y + XAUUSD + NASDAQ + 0700.HK` | 美联储/日央行政策分析 |
| B | AI 产业链 | `NVDA + AMD + AVGO + MSFT + GOOGL + NASDAQ + DXY` | AI 热潮影响分析 |
| C | 中美科技联动 | `NASDAQ + 0700.HK + DXY + US10Y + XAUUSD` | 跨市场影响分析 |

### 阶段10：多模型切换 + 定时报告
- 模型配置中心与运行时切换
- 每日定时生成报告并入库
- Dashboard 报告提醒与下载

---

## 4. 可执行边界与约束

### 4.1 数据与合规边界
- 优先使用公开、可稳定抓取的数据源（如 Reuters Business、SEC/EDGAR、HKEX、官方宏观接口）。
- 对受限源仅保留手工录入或引用，不纳入默认自动抓取。

### 4.2 Seed 与真实数据边界
- API 层必须暴露 `source_type`（`live` / `seed` / `fallback`）。
- 前端必须显式展示来源标签，避免混淆真实与演示数据。

### 4.3 LLM 输出边界
- 结论类内容必须附证据来源或引用事件。
- 明确标注“AI 分析，仅供参考”，避免过度决策暗示。

---

## 5. 验收标准（阶段6-10）

### 阶段6
- [ ] PG 向量链路可开关启用，且关闭时不影响现有流程
- [ ] 完成建表/索引/健康检查脚本
- [ ] 回归测试覆盖向量写入与检索

### 阶段7
- [ ] Research 页面去除演示态表达
- [ ] 上市公司返回真实财报字段
- [ ] 关键字段含数据来源与时间戳

### 阶段8
- [ ] 至少 14 家未上市公司画像可查询
- [ ] 关键事件有时间线与来源链接
- [ ] Seed/Live 来源区分在 API 与前端均可见

### 阶段9
- [ ] 提供 3 套关联预设与矩阵结果
- [ ] 支持事件因果链路输出
- [ ] 热度引擎支持异动阈值告警

### 阶段10
- [ ] 支持至少 2 个模型配置切换
- [ ] 定时报告稳定生成并可下载
- [ ] Dashboard 展示最新报告状态

---

## 6. 依赖与风险

| 风险 | 概率 | 影响 | 缓解措施 |
|------|------|------|---------|
| Yahoo Finance 限流 | 中 | 中 | 缓存 + 重试 + 回退链路 |
| RSS 源失效 | 中 | 中 | 多源冗余 + 周期巡检 |
| LLM 幻觉 | 中 | 中-高 | 证据链 + 置信度 + 明确标注 |
| Seed/真实混淆 | 中 | 中 | `source_type` + 前端标签 |
| 存储层切换复杂度 | 中 | 中 | 双栈兼容 + 开关灰度 |

---

## 7. 实施顺序

1. 阶段99：静态类型告警收口（并行）
2. 阶段6：Postgres + pgvector
3. 阶段7：Research 真实化
4. 阶段8：未上市公司情报
5. 阶段9：热度与关联分析
6. 阶段10：多模型与定时报告

---

## 8. 文档关系

- 主清单：`docs/todo.md`（唯一开发计划入口）
- 本文档：总体目标、范围、验收框架
- 详细步骤：`docs/implementation-roadmap-v2.md`
- 可行性：`docs/feasibility-assessment.md`

---

*文档版本管理：v1.0（初始）→ v2.0（修订）→ v2.2（现状对齐可执行版）*
